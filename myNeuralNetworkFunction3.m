function [Y,Xf,Af] = myNeuralNetworkFunction3(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 11-May-2018 14:24:10.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx2 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx2 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.0135688490100462;0.984928362121443];
x1_step1.gain = [120.42158550763;241.335646839647];
x1_step1.ymin = -1;

% Layer 1
b1 = [-19.799079702228464583;-19.600000929517413795;-19.401124854057123059;-19.202035404690878551;19.002943598922595214;18.804065758991001189;-18.605080920155408819;-18.391640959448203319;18.207200278664366522;-18.007338741563668094;17.810554417092369306;17.623356966676997359;-17.405359962495051462;17.225328977637580863;-17.013202353025413061;-16.813899986082898153;-16.615232708753264745;-16.416233781773485134;16.215172741012199964;-16.018249434613466065;-15.81895092666681002;-15.620398934310594896;-15.427805875853394468;15.224820019554034189;-15.023331140623788826;-14.824708715596218056;-14.625557356026725131;14.426399656445319408;-14.22964433913150728;14.022674497879808797;13.825120108041272005;13.624221109367963933;13.432938209309222444;13.232498884866226163;13.033505896516786038;-12.813759205376824113;-12.633744129068070094;-12.443135223048603422;12.237566605045937962;12.037759440828869728;11.83959695936273171;11.640613027776664623;11.441984501566087928;11.257117610320641177;11.048316055082279874;10.834217244623987497;-10.636409598714605451;10.449396893433796407;-10.247743053298323801;-10.070754946699166155;9.851585944029581654;9.6484976374696387325;9.4440439923329204674;9.2275111502249131945;9.0546056918000843439;8.8679413273492553316;-8.6464271696210808216;8.4735067956094844988;-8.2508289450512908303;-8.0401718182697514692;-7.8585348355114668095;-7.6880556400781028259;7.4772333790930032293;7.2309129093754238582;-7.0639555050874305309;-6.8520899917788939959;6.6342286238509569074;6.4828350544660180432;-6.1907623840200525223;6.0025779638008387451;-5.8763564864185910963;5.6138821732609622828;-5.4507123570321258654;-5.2722987080449721375;-5.0962081402928331997;4.8541341118710841229;4.6746238699609765632;-4.4686043407830817742;4.2556949768327312356;-4.0741562694678945533;-3.8759632374478392158;-3.6810047145119444423;3.4826521582276299682;-3.270317019704225725;-3.0748690166775030086;-2.9048482754611293366;-2.7510320120820788148;-2.5535696031445107579;-2.2435486016009180688;2.0792924425614200956;-1.9298554424603442392;-1.7028510681880686395;1.4838806655301624016;-1.288341160896118609;-1.0418506217156064952;-0.90029102584444531399;0.69933659235924394704;0.5007207859410228723;-0.29989450981614090841;0.09722088219521993202;0.10064569617847993199;0.29853564744543853449;-0.50103557367450402005;-0.69410417271286806162;-0.8817394430789688986;-1.0813774102245088393;-1.3256085696258714801;1.4571712645675789499;1.6919742114693281376;1.9167384527715662923;2.0444767710532700811;2.2500523576664823722;2.4920927031680482067;-2.7131558931015713476;-2.8820004992012537848;3.0539751155980043862;-3.2299397140409791263;-3.4849008526336571201;-3.8517499446363929749;-3.8482312165889585032;-4.0103756557802734406;4.3127724139391467872;4.5803172464628438831;4.6718126614806871899;4.8720612355484229639;5.1762055242589628534;5.272096118415003474;-5.4606694233332282451;-5.6769312710374757458;-5.882340418532725046;-6.0476464490842820609;6.2640554531027872187;-6.4663003511236123444;6.6659761052992010377;-6.8269550566000862801;-7.0303252973605507847;7.2459502140381966129;7.4618526774128373091;-7.6780523585506434969;7.8721400354812436362;-8.0588852711139349339;-8.2860623448001629043;-8.5019360029861257289;8.6558398270941143693;8.8545468893817460554;9.1684647894858777306;-9.3024877591583194913;-9.6754158981589082344;-9.6507638097895611651;-9.8663470816294118748;-10.020777741696328178;-10.322103229238095423;-10.652917761364001592;10.619245246048860665;10.866017188618187106;-11.063424143812321532;11.266474194291223654;-11.365929908392478964;-11.64061213248788107;11.892116216021380026;12.062019559782136469;11.925517232501588794;-12.437269423342311114;-12.638847850989391119;12.834521073445603889;13.026285270197117683;-13.251201105554498483;13.438281791244650165;-13.496308255026317369;-13.800227279466284358;-14.028454966299586104;14.223991944240422569;14.426397048028414716;14.803284408260287464;14.983665724873405978;-15.023338552467647489;15.202544877153522762;-15.442301577373784838;15.620309329102763485;15.818877314581573756;16.01827823914052118;-16.140256824973654659;16.419196013834362446;16.626422420664280111;-16.814217530526370581;-17.013202353371564612;-17.2985723344609994;17.411171999065739868;17.566614811382525119;-17.815547659348066389;-18.008151368184030616;18.199616891419548637;-18.399839867649593117;18.605080944427680123;18.812821543426338167;-19.003050581837470645;19.202034893177597041;19.401020227530398898;-19.599622938835825181;-19.806969376287955953];
IW1_1 = [17.528033444637966198 -9.2068001340092919804;9.6758152558620125205 -17.273642591375057975;14.142385684215451391 -13.856026254192903124;17.342507765045969137 9.5518283286087140027;-19.377762947809063832 -4.062705997741440811;-15.259780147194057065 -12.615035071663577071;18.224500479428559885 7.7374144654865908421;19.736090374120870194 1.7340026184740688908;-7.8973731429940086102 18.155682553743403673;13.721590056894722665 -14.273892368431779332;-17.205257463698625742 9.7945620814076459482;-0.38657403348394320242 -19.78453420980716615;12.086815140796691281 -15.687526033754526367;-19.686729225975753366 -1.9917977238847757171;17.386666511719589323 9.4712104620134844879;5.4090394233296281712 -19.046029143399284322;17.564222128778613552 9.1377295316074071962;1.8490228244160480386 -19.712467394817959843;-18.988177584773254125 5.6135065016875520527;18.889266810110044048 5.9326508241516116016;19.664395066132172474 -2.3066833802867865444;7.184678967193323551 18.449345168116778382;17.007756488723359212 -10.125501539377030014;-13.21811348416994214 14.737693618029616971;0.57630629274050204636 -19.790613352459505592;14.691330027094878119 -13.27228319399137213;7.4172900206451872762 18.357014845518012436;-17.090954758237771216 -9.9949620034633159804;19.762919778057426612 -1.1702613200535034732;-1.483186944498312787 -19.747740535703133702;-6.1544625399527346232 -18.821072669629398177;-19.678563974192289976 2.2184871308466425077;-19.762065533710746479 -1.1945662791764886101;-19.795480187975819319 0.37250366259850392625;-12.7191896492998886 -15.17307531994456582;1.5069992824635698447 -19.754220076788726601;11.37517510340468796 -16.206272552950849786;16.466255613097750654 -10.98739086805412235;-14.407199571062104582 -13.580596471422582638;-19.056626768135984662 5.3715710611714087008;-13.290127165335416493 -14.675575625140256264;-10.453927458321530253 -16.814142527477905276;-17.888286807453344096 8.4853918910429282363;-5.2117521746390460535 -19.091749139734520924;-11.037900368350259228 16.433657855149263582;-0.52936989201946993422 19.798015063026262794;18.933141355107807158 -5.8063992721028734323;-18.148851799942388396 7.9097751379535754523;10.851023691848730834 16.560645829162087495;19.576145249270126669 2.8828892281292586297;-18.933253416212092901 -5.7880374761849617826;-15.567766667636668387 12.235188767668278231;-11.622442355935501013 16.035635498986767544;-4.5878827974645641774 -19.272424803982122654;-9.9450605797462507951 17.120836900114191792;-14.526718057614141699 13.445841803252720936;15.554315396324613019 -12.255571688062568469;-14.428615834214987501 13.548709209942305876;16.708987492492006766 -10.625985659394837413;13.818013496812437069 -14.189552281664511213;19.300420846256049145 4.419313128389180001;4.9890515332959886052 19.149360189070847582;-6.7553040247809681418 -18.604373161265574055;-19.508628633519741413 3.4310671775608412304;12.899518333896148548 15.020068471854436609;14.649631638429912783 -13.325944940635485736;-18.506262647583884728 7.0676555048992995012;-18.287395553866328868 -7.5725007716272036973;3.4693767996068669568 -19.517261281324092437;-8.5118694218528094808 -17.89838535624252458;17.949015988280514478 8.3516403300283741373;-2.502332990399804391 19.657701025085490443;11.344266779203952211 -16.232727239547859455;17.977609891875125925 8.2956842122219232039;18.523001864762523638 6.9771132861977127604;-17.135592744362377005 9.9289469594957857623;-17.985579147192158445 8.2784921452331730052;19.799974933635329677 -0.4469761992205149026;-9.6612485024441010495 -17.285186300283946537;1.0958635402253005253 -19.770604648176341556;7.0763904843649951815 -18.491843823428517624;19.659087152206716098 2.3450474886232557381;-11.199732063454705511 16.326776387960471482;15.468125620766775441 -12.361321743329456879;18.266599723624789675 7.6411329955738622743;15.19300572915934211 -12.691479229112578864;18.877914819491969922 -5.9433746390638351187;4.6796983026532776861 19.240074926488873075;15.117319151972870017 -12.794676652559013874;-14.429610513426958107 -13.557676931689169209;19.719219044871557855 -1.7314023685247958984;5.5971371149074258255 -18.989855682506693313;-15.669069578291358269 12.10481556198099895;4.9316419103042807848 -19.175958477171175076;18.522775641152190218 7.0008396575653453198;13.288313802843518374 -14.676241340077044839;-16.353421470314870589 -11.161606632136493289;-15.066835343880795151 -12.84377015796874133;12.532174201799236357 -15.327436265349732025;-19.348617938345626044 -4.2005742521959055225;16.492499088140604613 -10.954953894600080844;14.713533065933528832 -13.247816063624389571;-3.0640094565239306412 -19.558690794785185574;-12.843542221057974828 15.068561461391167811;-14.987003200425419891 -12.935507965734279523;-7.5003542367851370187 18.32555138833796704;-19.759101591022410815 -1.1957612220594675545;18.756339225080413513 6.3473898383552240787;10.535075000513980825 16.763262888928672112;17.551158595776623628 -9.1533419638575495014;18.705598960854182167 -6.5097290653932491367;19.230500967431407133 -4.7339582989934241297;18.893643602182919494 5.8993467144410276504;-19.613327408608064673 2.6786113417609289655;-17.284214967950685349 -9.6560886222132324974;13.821179185871102391 -14.183873856326924212;-19.368651623567544107 4.1415377882865884729;-19.790761286248173434 0.57233968407528834632;-11.858021236603683235 15.81938063623529267;-3.7359716455622473674 19.447098036619362205;-9.1608758498572662177 17.564461098983422005;2.28216398736031989 19.658596205511138066;19.662229005028738271 2.0970642561826213779;7.7715643726902383648 18.210512212196896087;12.361086257134637378 15.466819549844045056;2.4871979971550057797 -19.611770414622519354;13.313573897059757911 -14.654586961886449714;-14.713294624958354717 13.256664936494978235;-17.849591942620435248 8.5619941359937890013;-1.4329130099585987157 19.743371043807208309;-17.177282004897445944 9.8609739389584198932;3.4520151301362784757 19.497044620111196878;-15.656044939932375115 -12.119975628522327682;13.030007811050316135 14.907010193155389999;-18.770516949866678402 6.3392646099355189904;-19.011265828824537749 -5.5707405257232132101;11.093127405864802171 -16.406927290380313167;15.688311027888936167 12.077976722078000549;-2.3534924939688495193 -19.652952135976345716;2.4072147017686766901 -19.648180181211419182;-14.668426864510189844 -13.298016901509358334;-18.537035196842655438 6.9216940594764837513;-13.900744362394000575 14.070678882441089996;13.192434446477790289 14.763457361842215576;16.663180017804808841 10.69307624338931717;19.732075639111492649 -0.86799110337226725864;-16.115729342224298648 11.461662138336963679;-3.8944477483598118894 19.298499794486346559;-12.771630546194730371 -15.128960759042048068;-8.9371393859308394525 -17.658919544273473434;-17.891659236996019899 -8.5101269321751455976;-0.77015329968097578917 19.747264718995275246;-8.6556289567293962506 17.674104389055006692;17.952604182944320144 8.3795336224177727757;18.201926478714188562 7.7610505492808039563;-8.8639896098607167119 17.691585493558719122;7.8251804112428668958 18.1733919916163984;-19.834171559955009911 0.27517159747570701933;-15.778406964118243394 -11.960011442643407875;11.179870159038825861 -16.304264319281504214;6.0381595579806770502 18.839835725213504247;13.718692634748236969 -14.524129589414162211;-9.3194228867064889954 17.467270887235500254;-10.966314443321117267 16.487820143826091623;12.855720291632986019 15.057571377348716979;15.314824031864429088 -12.557507949714990403;-19.497003186031054867 -3.3690938924650533082;8.6155749644798653719 -17.821517237377488385;-18.723926684355934213 6.7359712230392414511;-11.374381884433489631 16.229613961008343637;-17.95221868627772821 -8.3496921560269612428;5.3929890073146511398 19.052799224989406923;8.599201126784194571 17.834062581412197801;19.2957688207619249 -3.8298200107068649523;12.824966979708969816 -14.911117021694366258;-0.03322025673527963241 -19.798967321417595855;9.4500274149067013951 -17.41448806685354711;-19.015059342855106905 5.4595017398518903562;8.120010816694655631 18.057281348964753676;0.93536724787840752615 19.777280372141419207;12.940849952701038106 14.984472046144214019;-16.719006313158356392 10.73610289619215763;19.756308979858232533 -1.2583136176371980675;7.5530893154152352054 -18.292147899836475489;-14.90792867145362699 -13.02895478259291373;-11.473101977516446226 -16.135920519558830222;-16.258995277749853869 11.170000024899936264;12.860619158736090739 15.053387487670347511;10.413892721767854965 -16.880964688624931824;-1.8244200110542578841 -19.708938899314507154;-5.4090858626673616882 -19.045763597346564211;11.597592160713057652 -16.05404824519802176;-17.26132163159716626 9.7115741928310157505;8.108773050538504279 18.062330952841172405;18.186728408291465087 -7.8049719240192754199;-14.50735987564250884 -13.47354850952775962;18.762439188072722374 6.3222534357726356546;13.581135842925270651 14.406691126556800953;-19.557925915123021809 -3.0822305045599409645;-10.992507721487864814 16.457528634840016935];

% Layer 2
b2 = [-0.23792681067561741171;-0.51654655946185934479];
LW2_1 = [-1.0715217051308272289 -0.34772062779117424158 0.21383220956801859969 0.84665648850751340504 0.12887974884195138592 -0.26421900765225730945 -0.2792533173289332149 -0.56500872589479000929 0.94045300885969318472 -0.13600673665125417866 0.48090957018736596451 -0.023523177967586406112 0.6452804281048856172 -0.78277010825564652396 -0.28553520598409698472 0.67989788112711913026 -0.2907642803334453685 0.29863078678123422538 -0.054526024877886311581 -0.92089786681692198389 -0.23539390382031161186 0.65638002445408583085 -0.16499085463656676387 -0.68028656522503239135 0.026110127934125745841 -0.38997158133901910215 0.72640500051878786891 0.51521134629704123942 0.54270825494469598915 0.2740907381457580172 -0.21662380133274120042 -0.90557769730369985783 -0.374654588540314748 -0.62135942335175531337 -0.60995373177222500516 0.70240945117189523828 -0.81001322233923445104 0.95092327978602353422 -0.71252101975804649214 1.0230439588832531683 0.76303811811737332071 -0.68018449588958462826 -0.5218773274568826448 0.39733259450119701173 -0.2262478410846947563 -0.53563629719293093245 -0.41207264819974054326 0.40735154808911777646 0.74701850127705526905 -0.75649135009646539807 -0.64388632558549785401 -0.48466303311743319515 1.0785006216760038011 -0.4465789275572316086 0.68135974220011430447 0.31378969950847540593 -0.4721165285580312676 0.036227951979751787936 -0.51920109833034155944 0.46059769252293869535 0.14458401456546424169 -0.098697891787303149158 -0.26612843436433186728 -0.56793073279366701467 -0.89558678326622420673 0.23056845315684421083 -0.12894687962379580703 -0.018137314550354430298 0.36567369232554630676 0.58528785713689446268 0.22718541149429238857 -0.3928409613440030923 -0.76380461782609110344 -0.57196745576312624237 0.40262163667861178284 0.60245493833931285099 0.1216152976330152069 0.61460532564004310974 -0.48938846070782082709 0.33257929911420003322 -0.047578158504809522911 -0.6586279385124429453 -0.27526120642033152786 0.48392818975498314016 0.82429725976617362893 0.66301282164166963629 0.94106502664539259939 -0.9603028551570221838 -0.87229546154098203115 -0.41587887975862736223 0.177542953670882242 0.83614926019897872767 0.83511343216481359608 -0.58302803662772029192 -0.9752238408072069209 0.79514621352677539168 0.31106938725271326973 -0.4266416081583331299 0.84057886523203761975 0.48002523797917939774 -0.26501260128315834441 0.80086874972571098219 0.82258255439245508978 0.23675532868637735873 -0.54234478540769415211 0.73710112044956832555 -0.44352879000355205363 0.40216746179617030021 0.60382387450956231945 0.8432582569685873608 -1.02686967269715268 0.4994942298959347271 0.1104317440431107078 0.59537515300758958592 -0.36832763801477780286 -0.071653404324407588 -0.37329876241785164837 -0.87151927346431723453 -0.77643939771960690521 0.29608260590675217205 0.21392637450691665002 0.056856575644697593397 -0.72475598171832333882 0.37335279201155918694 0.052279295919177543039 -0.8680525026162839719 -0.057956077522243062972 -1.1252342596410338516 -0.45870338328783188953 -0.10503154081932217223 -0.36799900645619487705 -0.42462331098178762723 -0.37214426780047843435 0.42969805326411436575 0.28392823419540708096 0.053930431221771393813 -0.33699717882736879293 0.77394113661101515689 0.5711060525619294781 -0.39138472070733248964 -0.50572674138182838188 -0.65252315501835400635 -0.46669462874222583659 0.063401521188448439759 0.55629208294081045061 0.33649850025689553856 -0.4255629170427377983 -0.74278502730504225582 -0.66179602209637389265 0.28963369670913280407 -0.28642798713494910245 1.0064370032782197217 -0.16672807893731775297 0.3716566632724035979 0.47051269943381934802 0.51896342706273901335 -0.90159404016475686028 0.11897603005896083272 0.49833031948300410274 0.66917117484247534698 -0.70182259595533358354 -0.81331772723546280623 0.49843911472153584752 0.11439013509744191954 0.62942188727179604335 0.15833355036636398427 -0.17202748379079008112 -0.56372254157283641085 0.87508277524948974158 -0.042394988005027049727 -0.23039025007297042613 0.17985346467137733328 0.6679472193394565549 -0.90898639627574784328 0.78853183068262544531 0.65963272207415557524 0.18948241255614117762 -0.099736603789784633589 -0.53540139625512639387 0.30523559835080726899 -0.30609862648804747609 -0.15464204348826068869 -0.64823863541328097249 0.28451861595491551027 0.92965863227773848365 0.58746278695119436009 0.7515301841997912291 0.49403360240743132703 0.94574770894224768902 0.16616543654379498096 0.35335737869345501538 -0.16336898072632896617 0.76181108758910431877 -0.91402949452329640412 0.5206455960044523712 0.97737492742718734551 0.02609449299445899817 -0.15891232454216819292 0.37540166652217382692 -0.068121247013176178253;0.73464654144736141195 -0.43503405440560166673 0.56358493379468932449 0.43754260769577318912 -0.95102131419595525852 0.034020384121203520178 0.85834272199219729949 -0.11596601969430607448 0.45611739699293940564 -0.30092011284109732028 0.032902155187113139856 -0.53691031024402924299 -0.033145878235906797715 -0.39801588742735616311 -0.14130279008819462971 -0.12844967275571553267 -0.41939422126147046788 -0.53564466807655208846 0.28025482958203440376 -0.87185022165264602911 -0.62446072819110864938 -0.7823440800276904028 0.28744999767140161362 -1.0090599790446450612 -0.25591418903809054486 -0.31750917826346619632 -0.0005328924865020253851 0.55418478190260644922 0.94517522335277392997 0.58360182871709698205 -0.37568073859103978673 -0.61804836073563296228 -1.0763713195689632585 -0.62632600462135601393 0.1095232431169554238 -0.84980055584939129254 -0.24475582354244551642 -0.82304820175682580352 -0.36994556625364100055 -0.68777388929874050394 0.7952778548448359297 -0.5682952369536036219 -0.44256960970710979009 0.23538816340895241108 -0.073137885933701934915 0.15738410121092136218 0.22457001921155400614 0.49547125816478315707 0.028969691578785611991 0.35348475770335607837 -1.0214808589586366061 -0.83495498356559538777 -0.70848446806738440973 -0.72222507443482253375 -0.27675882255077827176 -0.6241512248260950857 -0.79604107133609380842 -0.55636998226834266656 -0.62812194726892600638 0.19022469862165697352 -0.71624725768180053098 0.36214263977907407144 -0.060331564777888292694 0.60238681533670224155 -0.096035565794766408754 -0.026533549777060874003 0.26383318299415448038 -0.97804335556383803496 -0.85265164913433499905 -0.67362752110501322722 0.57389773859651183052 0.66714037247829782729 0.71429286363213395639 -0.8124396828589720565 -0.95025813491480437545 -0.61557633124673050151 0.058210942084129739527 -0.81437591776330375826 0.13154931578327799802 -0.59197084747286066175 0.35101363523851425441 -0.5053940935479545038 -0.24463748156733494676 0.92907660866233432451 0.68874329622882835 0.22824793861852890609 -0.82580612005482156857 1.0021379263347744981 0.15821493061930916313 0.25286658358587810191 -0.82251658919796899472 0.63707297787256966792 0.16216715813087506648 -0.14159473100053010519 0.37218205294774742153 -0.22284043560132879569 0.91159611380257710156 -0.70306173849187136859 -0.57947457176140182433 0.26046381360301140706 0.97462570603611498044 0.18117655602426671613 0.041061200905169348285 -0.92131136709702532439 0.70672876959464803193 -0.914190600520515817 0.072377994125441949547 0.625418285658778772 0.3028271748857418455 0.03610111653223221917 -0.21301077082135067009 0.90725456135900961474 0.80268800674999862821 0.89422404047909609393 -0.31838523397433871054 0.13518094334381586252 -0.68704229197008648278 -0.55334970970572172622 0.87396402244825466266 -0.19373265675404169328 -0.51628445423142543813 -0.79145886852275049161 0.020812766104648827703 -0.18951752831004337052 -0.64362944586645720602 0.1748903963966405295 -0.25127242567693319764 0.18679734565269290325 -0.44141432830985233293 -0.24687895249507954554 0.11773181952671557537 -0.57015549837809409439 0.7273116884401850113 -0.90041195481351499197 0.605645394978222118 -0.80560573691152148612 -0.49798887510296208081 0.027906843348831224944 -0.59764363833551359395 0.074149704886142461802 -0.13421308367839615561 -1.0768438155560515757 -1.0537430371419629349 0.37577264656566333745 0.27485156241839747704 -0.4624901612854166455 -1.0549628966480262271 0.096321665923116500663 0.64909324605333351688 -0.95308984705547994398 0.25830099610342999172 -0.4087603157174718449 0.73378570347720772915 -0.46042192362141048934 0.67456582961277844479 0.48223263761587226162 0.32942049340488577247 -0.91640681993899186786 0.59673083638316171129 0.38016818058559814775 0.32257495200815239356 0.901648505047278781 0.52040701539871603298 0.95046583581089894022 -0.97059656187075715739 -0.16731900547493733233 0.039807354775182199336 -0.44473818965061440167 -0.4585247845275537415 0.26797914376078590948 -0.70341513547580536425 0.065776477141053155129 0.15513832635633137413 0.93462887304007147282 -0.78288851124425273831 0.06802176156329858836 0.17975031718914624701 -0.34662962204803932087 -0.083273404002651346678 -0.9381720333150086466 0.027336267470016009651 0.92636209242864508973 -0.72367132897273322989 0.5194126934298652909 -0.97660770325313706053 0.9826144042422769731 -0.023561247591969512044 0.46606780208701664714 0.19147916189692720801 0.026141285185163991994 -0.70292868722847867691 -0.42745538048413583843 -0.19257718335474974247 0.892045874151310203 -0.11587126083633055018 -0.090600056399743125746 -0.95289975530519110958 -0.48855026247898453162 0.87094797645614541182 0.38114721425312814151];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
